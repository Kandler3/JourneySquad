# Шпаргалка по работе с git

В нашем репозитории три основных папки, каждая из которых содержит отдельное приложение:
- **api** — серверное API-приложение
- **bot** — Telegram-бот
- **miniapp** — Telegram Mini App

## Основные ветки

- **main**: Основная ветка проекта. В эту ветку попадают стабильные и протестированные изменения (см. Trunk-Based Development).

> **Важно:** Никогда не работайте напрямую в `main`. Все изменения делаются в отдельных ветках и вливаются через pull request.

## Работа с feature-ветками

При добавлении новой функциональности создавайте feature-ветку от ветки `main` с именованием, соответствующим целевому приложению:

- **Для API:**
  ```bash
  git checkout main
  git pull origin main
  git checkout -b feature-api-<описание_фичи>
  ```
- **Для бота:**
  ```bash
  git checkout main
  git pull origin main
  git checkout -b feature-bot-<описание_фичи>
  ```
- **Для miniapp:**
  ```bash
  git checkout main
  git pull origin main
  git checkout -b feature-miniapp-<описание_фичи>
  ```

## Процесс Pull Request (PR)

1. Завершив работу в ветке, сделайте коммиты с подробными сообщениями.
2. Опубликуйте ветку на удалённом репозитории:
   ```bash
   git push origin <название_ветки>
   ```
3. Создайте Pull Request для слияния изменений в соответствующую ветку (`main`).
4. После успешного ревью и тестирования, ветку вливают в целевую ветку.

## Удаление ветки  
После успешного вливания feature-ветки в `main`, удалите её локально:  
```bash
git branch -d <название_ветки>
```  
> **Важно**: Флаг `-d` (с маленькой буквой) удаляет **только** если ветка уже влита в целевую. Если Git отказывается удалять, убедитесь, что ветка влита.  

После удаления локальной ветки её также нужно удалить на удалённом репозитории (`origin`):  
```bash
git push origin --delete <название_ветки>
```  

## Полное удаление ветки (локально и удалённо)  
```bash
git branch -d <название_ветки>  # Удаляем локально
git push origin --delete <название_ветки>  # Удаляем на удалённом репозитории
git fetch --prune  # Обновляем список удалённых веток
```

## Рекомендации

- **Обновляйте ветку**: перед началом работы убедитесь, что у вас актуальная версия ветки `main`.
- **Пишите понятные имена веток и коммитов**: например, `feature-api-user-authentication` или `bugfix-bot-crash-on-empty-message`.
- **Не забывайте синхронизировать** свою локальную ветку с удалённой.
- **Обсуждайте изменения** через PR и ревью, чтобы избежать конфликтов и недоразумений.
