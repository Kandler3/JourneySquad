# Git Flow Cheat Sheet

В нашем репозитории три основных папки, каждая из которых содержит отдельное приложение:
- **api** — серверное API-приложение
- **bot** — Telegram-бот
- **miniapp** — Telegram Mini App

## Основные ветки

- **main**: Продакшн-версия проекта. В эту ветку попадают стабильные и протестированные изменения.
- **develop**: Ветка интеграции. В ней собираются все новые фичи и исправления перед релизом в main.

> **Важно:** Никогда не работайте напрямую в ветках `develop` или `main`. Все изменения делаются в отдельных ветках и вливаются через pull request.

## Работа с feature-ветками

При добавлении новой функциональности создавайте feature-ветку от ветки `develop` с именованием, соответствующим целевому приложению:

- **Для API:**
  ```bash
  git checkout develop
  git pull origin develop
  git checkout -b feature/api-<описание_фичи>
  ```
- **Для бота:**
  ```bash
  git checkout develop
  git pull origin develop
  git checkout -b feature/bot-<описание_фичи>
  ```
- **Для miniapp:**
  ```bash
  git checkout develop
  git pull origin develop
  git checkout -b feature/miniapp-<описание_фичи>
  ```

## Работа с bugfix-ветками

Если необходимо исправить баг, создавайте ветку от `develop` с префиксом **bugfix**:
- **Пример для API:**
  ```bash
  git checkout develop
  git pull origin develop
  git checkout -b bugfix/api-<описание_ошибки>
  ```
- Аналогично для **bot** и **miniapp**.

## Работа с release-ветками

При подготовке к релизу создавайте release-ветку от `develop`:
```bash
git checkout develop
git pull origin develop
git checkout -b release/<версия>
```
После завершения тестирования:
1. Слейте release-ветку в `main`.
2. Слейте изменения из release-ветки обратно в `develop`.

## Работа с hotfix-ветками

Для критических исправлений в продакшене:
1. Переключитесь на ветку `main`:
   ```bash
   git checkout main
   git pull origin main
   ```
2. Создайте ветку hotfix:
   ```bash
   git checkout -b hotfix/<версия>
   ```
3. После исправления:
   - Слейте hotfix-ветку в `main`.
   - Слейте изменения из hotfix-ветки в `develop`.

## Процесс Pull Request (PR)

1. Завершив работу в ветке (feature/bugfix/release/hotfix), сделайте коммиты с подробными сообщениями.
2. Опубликуйте ветку на удалённом репозитории:
   ```bash
   git push origin <название_ветки>
   ```
3. Создайте Pull Request для слияния изменений в соответствующую ветку (`develop` или `main`).
4. После успешного ревью и тестирования, ветку вливают в целевую ветку.

## Удаление ветки  
После успешного вливания feature-, bugfix-, release- или hotfix-ветки в `develop` или `main`, удалите её локально:  
```bash
git branch -d <название_ветки>
```  
> **Важно**: Флаг `-d` (с маленькой буквой) удаляет **только** если ветка уже влита в целевую. Если Git отказывается удалять, убедитесь, что ветка влита.  

После удаления локальной ветки её также нужно удалить на удалённом репозитории (`origin`):  
```bash
git push origin --delete <название_ветки>
```  

## Полное удаление ветки (локально и удалённо)  
```bash
git branch -d <название_ветки>  # Удаляем локально
git push origin --delete <название_ветки>  # Удаляем на удалённом репозитории
git fetch --prune  # Обновляем список удалённых веток
```

## Рекомендации

- **Обновляйте ветку**: перед началом работы убедитесь, что у вас актуальная версия ветки `develop` (или `main` для hotfix).
- **Пишите понятные имена веток и коммитов**: например, `feature/api-user-authentication` или `bugfix/bot-crash-on-empty-message`.
- **Не забывайте синхронизировать** свою локальную ветку с удалённой.
- **Обсуждайте изменения** через PR и ревью, чтобы избежать конфликтов и недоразумений.
